NIN3_128_DET1x4での認識

学習データセットでは、99％近いPrecisionが得られても、位置推定は右半分だけOK;-<

[■学習とテスト結果]
・カメラ画像について
主観的には、50%のスレッショルドで、
ロバスト性あり
推定位置は右半分に寄っていて、左半分のターゲットを追跡することができない
な印象

[■改善策]
・推定位置が四隅に集中する⇒augmentationを4方向から8方向
・posi:nega=6:4の10万画像とイメージファイルを左右にシフトした4万画像

[■結果]
・推定位置は右半分で正解、左半分の不具合は改善できず
・ロバスト性は向上した(感覚)
・スレッショルドは50%近辺
・空、雲、雪山では誤検出している

[■次の手：データセットの見直し]
・ポジネガ比率が4:6では厳しい⇒データセットのクロッピング
・雪山、空、雲のネガ画像増強⇒FlickrAPIでデータセット追加
・頭から靴までを捕らえている画像増強⇒案無し
・wiki、imdb、vocデータセットに対して、
　①YOLOを利用して人が1名のみな画像を選択して、問題を簡単にする
　②顔(vocでは人)部分が4隅に当たるように画像をクロッピング(元画像は非常に大きいから可能)
　③データセットのx,y,r,cヒトグラムを表示して分布を確認
　　データ拡張後のx,y,r,cヒトグラムを表示して分布を確認
　(wikiやimdbは顔検出のタスク用なので上半身画像が中心で人を顔で代表する趣旨でのデータ不足を対策)

[■次の手：教師信号の見直し]
汎化性能不足により左半分での位置推定に誤ると仮定する
・左端の正解と中心の正解のサンプルが与えられているので正解データの分布には左右差はない
・ネガデータを推定する場合、推定結果が右半分の領域へ寄っているのが気になる
　ネガデータでの誤差は無視する仕様で学習させているが、YOLOなどでは、ネガデータの正解をx,y=(0.5,0.5)としている

ネガデータの位置推定が右半分に寄る傾向があると仮定する
・左半分に正解ありの場合、画像の右半面はネガなので右半面に位置推定され、汎化して右半面に位置を推定する
・右半分に正解ありの場合、画像の左半面はネガなので右半面に位置推定され、汎化して右中心に位置を推定する
となっている可能性が高い

実験として、ネガデータの正解値を、
(C, R, X, Y) = (0.0, 0.5, 0.5, 0.5)
とし、ネガ画像の位置推定を中央部寄せる
これで、位置推定でのネガ画像の影響を避けることはできないか試す

[■学習結果とその考察]
ネガ画像の教師信号をx,y=(0.5,0.5)とした場合とネガ画像のロスを無視した場合の違いについての見解
ネガ画像のロスを無視した場合、ネガ画像の位置推定は(0.8,0.5)周辺になっている
(ブラック画像からの位置推定結果)
右半分での位置推定が機能して見えるのは、単にネガ画像の推定位置が右半分にあることが原因かもしれない

一方、ネガ画像の教師信号を(0.5,0.5)とした場合、ネガ画像の位置推定は(0.5,0.5)周辺になっている
(ブラック画像からの位置推定結果)
カメラ画像での位置推定で、x値は0.35~0.85の範囲で推定可能となった
対象物の移動に伴い位置推定結果が多少左右に移動して対象物を追跡する現象が見られた

ただし、2m程度離れた対象物(55%スレッショルドで認識可能)については、位置推定が中心を指した
ネガ画像が映像の大半を占めている影響であると推測できる

[■位置推定におけるネガ画像の影響について]
・YOLOでのネガ画像の学習方針である"ネガ画像の教師信号はr,x,y=(0.5,0.5,0.5)とする"を真似て成果が得られた
・ネガ画像のロスを無視すると対象物追跡が正しく働かない(ネガ画像の位置推定がx,y=(0.8,0.5)になってる)
・ネガ/ポジ画像間の汎化効果により、対象物の移動を追跡できる位置推定になった
・対象物存在推定の距離限界は2m程度である
・対象物の画像全体に占める面積割合が大きいと推定が正しく働く

[■ロス評価関数について]
評価関数は2乗差分
