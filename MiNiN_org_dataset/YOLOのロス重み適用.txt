NIN3_128_DET1x4での認識

学習データセットでは、99％近いPrecisionが得られても、位置推定は右半分だけOK;-<

各種改善策を試した現状は、
[■位置推定におけるネガ画像の影響について]
・YOLOでのネガ画像の学習方針である"ネガ画像の教師信号はr,x,y=(0.5,0.5,0.5)とする"を真似て成果が得られた
・ネガ画像のロスを無視すると対象物追跡が正しく働かない(ネガ画像の位置推定がx,y=(0.8,0.5)になってる)
・ネガ/ポジ画像間の汎化効果により、対象物の移動を追跡できる位置推定になった
・対象物存在推定の距離限界は2m程度である
・対象物の画像全体に占める面積割合が大きいと推定が正しく働く
・ロス評価関数は2乗差分
となっている

[■YOLOのロス重み付けを適用]
YOLOでのネガ画像の学習方針である"ネガ画像の教師信号はr,x,y=(0.5,0.5,0.5)とする"を真似て成果が得られた
さらにネガ画像が映像の大半を占めると位置推定がx,y=(0.5,0.5)となる現象を改善できるかロス重みを試す
ただし、
・ネガ画像の教師信号をx,y=(0.5,0.5)として学習しているので映像の大半がネガ画像であれば正しい挙動である
これを前提にYOLOのロス重み付けを考察する

YOLOのロス重みλは、
①λ推定位置重み_正解が存在のケース　= 1.0

これを基準の1.0として、ネガ画像(非在ケース)の場合、
②λ推定位置重み_正解が非在のケース  = 0.1
をロス値に掛けて、ネガ画像の場合にx,y=(0.5,0.5)と位置推定する確率を1/10に下げている

存在確率については、
③λ存在確率重み_正解が存在のケース = 5.0
④λ存在確率重み_正解が非在のケース = 1.0(IoU<0.5) or 0.0(IoU>0.5)
をロス値に掛けて、正解が存在のケースでc=(1.0)と推定する確率を5倍に上げている

以上YOLOのロス重みは４つのケースを持つ仕掛けである
特に④は、
自Gridに対象は存在しないが、近くのGridに対象が存在し、BBOXを推定しているので存在確率をロスとして見ない
を意味しているが、今回のNNは最終段が1x1x4であり周辺の概念を扱う④の状況が無いので、
⑤λ存在確率重み_正解が非在のケース = 1.0
とし、
①②③⑤の適用を試す

[■YOLOの重み付け適用結果]
①ブラック画像では、
　(C,R,X,Y) = ( 0.53, 0.34, 0.46, 0.45 )
となった
②カメラ画像入力
　大写しの上半身では
　　X：0.2～0.8まで追跡可能
　　Y：0.2～0.6まで追跡可能
③背景画像との関係
　画像を背景画像が半分以上を占める(対象が小さく写る)場合、追跡が効かずx,y=(0.5,0.5)付近を指し示す
　例えば、
　服は背景画像データに含まれ、x,y=(0.5,0.5)として教育されるので服と顔を含む学習には矛盾がある
　服と顔の映る画像のX,Y推定は、顔に引っ張られている(顔座標)のか、服に引っ張られているのか(0.5,0.5)その汎化
　汎化の効きは、画像に占める割合に依存している
　単純に、対象の面積αと背景の面積ε(=1-α)を考えると
　　推定位置(X,Y) = α*(顔座標)～ε*(0.5,0.5)
　　α≒0.25(大写しの顔)でありこれで追跡成功
　　α≒0.15(少々引いた)では追跡失敗
　　背景と対象の位置推定誤差のロス重みは10倍であるが、面積比で考えると4倍程度が妥当
　　(つまり面積1/2で縦横は1/4なので横のロス値は4倍あれば十分って自説)
　　大きな対象物はロスが大きく出るが小さな対象物はロスが小さく出る
　　対象物の例として、正解ボックス1＝縦横0.5と正解ボックス1＝縦横0.25があるとする
　　正解と推定の高さは同じ位置にあり重なりは無く接している場合のロスは、
　　小さいボックス2のロス値：(0.25-0.5)^2、または、(0.25-0.0)^2　＝　0.06
　　大きいボックス1のロス値：(0.50-1.0)^2、または、(0.50-0.0)^2　＝　0.25（4倍)
　　ロス重みは正しいと考えられる
　単純に、人の全景が写った教師信号は画像の中心に偏ったり、量が少なかったりなのかもしれない
　YOLOといえども、出力チャネルごとの精度はどの程度なのかわからない

[■YOLOと同じ条件で学習でききているか否か判断が必要だ]
                    YOLO    MININ
入力画像サイズ       448      128
出力特徴サイズ        11        1
出力特徴サイズ当り    56      128

[■FaceDetectorと比較]
Windows7上CPUのみではチョー遅い　CUDAはVisualC++が必要なので立上げ

[■λを変更して試す]
λ非存_推定座標 = 0.01
λ存在_推定座標 = 1.00
100倍にして背景画像からの位置推定の影響を下げる試み⇒位置推定精度に変化なし
