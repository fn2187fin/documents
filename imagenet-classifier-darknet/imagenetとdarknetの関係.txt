YOLOの学習方法は、

■分類器をImagenetの1000分類で学習

■分類器の後段層を取り除き、検出器をつける

■ファインチューン学習する

この流れでモデルを学習している
YOLOv1,v2,v3どれもこの流れを使っているらしい

調査
1. 分類学習は、ImagenetからVOC物体検出に有効な1000カテゴリを選んでいる
   1000カテゴリの選択方法
2. 分類学習は、1,600,000エポックなど膨大なエポック数になっている
3. 分類学習後のウェイトから特徴抽出層と考えられる前段層のウェイトを取り出し物体検出ネットワークへロードしてファインチューン学習する
   分類学習したネットワークからの特徴抽出層の選択方法

yolov2のファインチューンでは、下記
./darknet detector train cfg/voc.data cfg/yolov2-voc.cfg darknet19_448.conv.23
darknet19_448から前方23層をpartialコマンドで切り出して使っている
"ウェイトサイズとネットサイズが違う".txt

■1000カテゴリ
darknet分類器が学習している1000カテゴリをダウンロード
内容を確認すると、
 車、楽器、爬虫類、植物、時計やメータ、哺乳類、昆虫、ガジェット、鳥類
 身の回りの道具、魚類、食品、スポーツ、子ども、環境として部屋、風景
確かにレパートリーに富んだ選択かもしれない
ヒトは写り込んでいるだけで、スポーツ、子ども、野球、、など
Imagenetは20,000以上カテゴリがあるから、人手1,000選択だとすれば大変なコスト
また、VOCやCOCOに適した1000カテゴリを選択しているとすれば、、、タスクが変わるとこの選択も変るのかも
※VOCやCOCOなどタスクの検証データを見て、相当する学習データをImagenetカテゴリから選ぶ？

■分類器の学習エポック数
darknet.cfg:       max_batches=1,600,000
darknet19.cfg:     max_batches=1,600,000
darknet19_448.cfg: max_batches=  100,000
extraction.cfg:    max_batches=1,600,000
160万エポック！

後の検出器のエポック数は、
yolov2-tiny-voc.cfg:max_batches = 40,200
yolov2-voc.cfg:     max_batches = 80,200
数万エポックと分類機に対して2桁少ない！

■分類器から層の取り出し基準
分類器から全てのConvolutional層を取り出している

■検出器を1から学習させる
Imagenet 10,000カテゴリで分類器
VOC      20カテゴリで検出器


